{% extends "crud/list.html" %}
{% load i18n_sapl common_tags crispy_forms_tags%}

{% block base_content %}
  {% if user.is_authenticated and perms.comissoes.add_composicao %}
  <div class="context-actions clearfix">
    {% block actions %}
      <div class="actions btn-group pull-right btn-group-lg" role="group">
        {% if view.create_url %}
        <a href="{{ view.create_url }}" class="btn btn-default">
          {% blocktrans with verbose_name=view.verbose_name %} Adicionar {{ verbose_name }} {% endblocktrans %}
        </a>
        {% endif %}
        {% block more_buttons %}{% endblock more_buttons %}
      </div>
    {% endblock actions %}
  </div>
  {% endif %}

  <fieldset class="form-group">
		<legend>Selecione o Período</legend>
		<form method="GET">
			<select name="pk" class="form-control" onChange="form.submit();">
				{% for c in composicao_list %}
					<option value="{{c.id}}" {% if composicao_pk == c.id %} selected {% endif %}>
						{{c}}
					</option>
				{% endfor %}
			</select>
		</form>
	</fieldset>
	<br/>
  {% if user.is_authenticated and perms.comissoes.add_participacao %}
    <div class="actions btn-group pull-right btn-group-lg" role="group">
        <a href="{% url 'sapl.comissoes:participacao_create' composicao_pk %}" class="btn btn-default">
        Adicionar Participação em Comissão
        </a>
    </div>
  {% endif %}
  <br />

  <div class="container-table">
    <table class="table table-striped table-hover table-link-ordering">
      <thead>
        <tr>
          <th>Participações em Comissão</th>
          <th>Cargo</th>
          <th>Titular?</th>
          <th>Designação</th>
          <th>Desligamento</th>
          <th>Motivo</th>
          <th>Observações</th>
        </tr>
      </thead>
      <tbody>
      {% for p in participacao_set %}
      <tr>
        <td>
          <a href="{% url 'sapl.comissoes:participacao_detail' p.pk %}">{{ p.parlamentar }}</a>
        </td>
        <td>{{p.cargo}}</td>
        <td>{{p.titular|yesno:"Sim,Não"}}</td>
        <td>{{p.data_designacao}}</td>
        <td>{{p.data_desligamento|default:""}}</td>
        <td>{{p.motivo_desligamento}}</td>
        <td>{{p.observacao}}</td>
      </tr>
      {% endfor %}
    </tbody>
    </table>
  </div>
{% endblock base_content %}
