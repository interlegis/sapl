{% extends "base.html" %}
{% load i18n %}
{% load tz %}
{% load common_tags %}
{% block base_content %}
  <fieldset>
    <legend>Proposições Não Recebidas</legend>
    {% if not object_list %}
      <p>{{ NO_ENTRIES_MSG }}</p>
    {% else %}
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            {% with 'Data Envio,Tipo,Descrição,Autor' as list %}
            {% for name in  list|split:"," %}
            <th>
                  <a title="{% trans 'Clique para alterar a ordem a listagem'%}" href="?o={% if 'o' not in request.GET and forloop.counter == 1 or 'o' in request.GET and forloop.counter|safe == request.GET.o %}-{%endif%}{{forloop.counter}}">
                  {{ name }}
                  {% if 'o' in request.GET %}
                    {% if 'o' not in request.GET and forloop.counter == 1 or 'o' in request.GET and forloop.counter|safe == request.GET.o %}
                      <span class="caret top" title="{% trans 'Listado na Ordem Ascendente'%}"></span>
                    {% elif 'o' in request.GET and forloop.counter == request.GET.o|str2intabs %}
                      <span class="caret" title="{% trans 'Listado na Ordem Descendente'%}"></span>
                    {%endif%}
                  {%endif%}
                </a>
              </th>
              {% endfor %}
            {% if not AppConfig.receber_recibo_proposicao %}
                <th>Código do Documento</th>
            {% endif %}
            {% endwith %}
          </tr>
        </thead>
        <tbody>
          {% if 'o' in request.GET %}
            {% define object_list|sort_by_keys:request.GET.o as list %}
          {% else %}
              {% define object_list as list %}
          {% endif %}

          {% for prop in list %}
            <tr>
              <td>
                 <a href="{% url 'sapl.materia:proposicao_detail' prop.pk %}">{{ prop.data_envio|localtime|date:"d/m/Y H:i:s" }}</a>
              </td>
              <td>{{ prop.tipo.descricao }}</td>
              <td>{{ prop.descricao }}</td>
              <td>{{ prop.autor }}</td>
              <td>
                {% if not AppConfig.receber_recibo_proposicao %}
                  {%if prop.hash_code %}
                    <a href="{% url 'sapl.materia:proposicao-confirmar' prop.hash_code|strip_hash prop.pk %}">{{ prop.hash_code }}</a>
                  {% else %}
                    {{ prop.hash_code }}
                  {% endif %}
                {% endif %}
              </td>
             </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}
  </fieldset>

  {% include 'paginacao.html'%}
{% endblock %}
