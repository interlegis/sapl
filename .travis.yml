language: python
sudo: required

python:
  - "3.4.3"

services:
  - postgresql

addons:
  postgresql: "9.3.12"

install:
  - sudo apt-get install git nginx python3-dev libpq-dev graphviz-dev graphviz postgresql-contrib pkg-config python-psycopg2 nodejs npm
  - sudo ln -s /usr/bin/node
  - pip install -r requirements/dev-requirements.txt
  - pip install --upgrade setuptools

before_script:
  - sudo service postgresql restart
  - npm install -g bower
  - cp sapl/settings_travis.py sapl/settings.py
  - sed -i -e 's/getpass.getuser()/"postgres"/g' sapl/settings.py
  - psql -c 'create database sapl;' -U postgres
  - python manage.py syncdb –migrate –noinput

script:
  - python manage.py test
  - ./manage.py bower install
  - ./test_and_check_qa.sh